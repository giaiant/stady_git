{
  "id": "branch-basics-enhanced",
  "title": "ブランチ基礎（詳細解説付き）",
  "description": "ワークツリーとブランチの関係を詳しく理解する",
  "steps": [
    {
      "goal": "feature/todo ブランチを作成して切り替える",
      "checks": [
        { "predicate": "currentBranchIs", "args": ["feature/todo"] }
      ],
      "hints": [
        "git branch feature/todo",
        "git checkout feature/todo",
        "git branch で現在のブランチを確認"
      ],
      "explain": "ブランチを作成しただけでは、ワークツリーは変わりません。checkout でブランチを切り替えると、HEADが移動し、ワークツリーがそのブランチの内容に更新されます。",
      "preStep": {
        "message": "これからブランチを作成し、ワークツリーとの関係を確認します",
        "tips": [
          "ブランチは単なるコミットへのポインタです",
          "ワークツリーは常に1つのブランチを指しています",
          "切り替え前後でワークツリーの内容を比較してみましょう"
        ]
      }
    },
    {
      "goal": "README.md に1行追記してコミットする（未コミット変更が残らないこと）",
      "checks": [
        { "predicate": "noUncommittedChanges", "args": [] }
      ],
      "hints": [
        "Add-Content README.md \"ロールプレイ: 1行追記\"",
        "git status",
        "git add README.md",
        "git commit -m \"docs: update README\""
      ],
      "explain": "ファイルを編集するとワークツリーが変更されます。git add でステージングエリアに追加し、git commit で現在のブランチ（feature/todo）に保存されます。",
      "preStep": {
        "message": "ワークツリーでファイルを編集し、ブランチに保存するプロセスを体験します",
        "tips": [
          "編集 → ワークツリーが変更される",
          "git add → ステージングエリアに追加される",
          "git commit → ブランチに永続的に保存される"
        ]
      }
    },
    {
      "goal": "main ブランチに切り替えて feature/todo をマージする",
      "checks": [
        { "predicate": "isMerged", "args": ["main", "feature/todo"] }
      ],
      "hints": [
        "git checkout main",
        "git merge feature/todo",
        "git log --oneline で履歴を確認"
      ],
      "explain": "mainブランチに切り替えると、ワークツリーの内容がmainブランチの最新コミットに戻ります。マージにより、feature/todoの変更がmainに統合されます。",
      "preStep": {
        "message": "ブランチを切り替えてワークツリーの変化を観察し、マージを実行します",
        "tips": [
          "checkout main → ワークツリーがmainの内容に変わる",
          "merge → 2つのブランチの変更を統合する",
          "Fast-forward → 単純にブランチポインタを進める"
        ]
      }
    }
  ],
  "summary": {
    "keyPoints": [
      "ワークツリーは現在のブランチの内容を物理的に表示する",
      "ブランチ切り替えでワークツリーの内容が変わる", 
      "変更はワークツリー → ステージング → ブランチの順で保存される",
      "マージにより複数のブランチの変更を統合できる"
    ],
    "nextSteps": [
      "コンフリクトが発生するマージの体験",
      "リベースによる履歴の整理",
      "スタッシュによる作業の一時保存"
    ]
  }
}
